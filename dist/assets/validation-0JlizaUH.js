const l=e=>typeof e!="string"?"":e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),t=e=>{if(!e||typeof e!="string")return!1;try{const i=new URL(e);return i.protocol==="http:"||i.protocol==="https:"}catch{return!1}},r=e=>{const i=parseFloat(e);return isNaN(i)||i<0?!1:(e.toString().split(".")[1]||"").length<=2},n=e=>{const i=parseInt(e);return!isNaN(i)&&i>=0&&Number.isInteger(i)},c=e=>{const i=[];return!e.name||e.name.trim().length===0?i.push("Product name is required"):e.name.length>200&&i.push("Product name is too long (max 200 characters)"),(!e.price||!r(e.price))&&i.push("Valid price is required"),e.offerPrice&&!r(e.offerPrice)&&i.push("Offer price must be a valid price"),e.stock!==void 0&&!n(e.stock)&&i.push("Stock must be a non-negative integer"),e.images&&Array.isArray(e.images)&&e.images.forEach((s,a)=>{s&&!t(s)&&i.push(`Image #${a+1} has an invalid URL`)}),{isValid:i.length===0,errors:i}};export{l as s,c as v};
