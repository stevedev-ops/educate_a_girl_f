import{j as e,u as O,a as _,e as F,r as g,L as x,h as $,i as T}from"./index-BCqjIhcd.js";import{E as D,l as I,u as R,a as z,C as v,b as L}from"./index.es-DuE_dP4L.js";const A=I("pk_test_TYooMQauvdEDq54NiTphI7jx"),Q=()=>{const{cartItems:l,cartTotal:o,clearCart:w,removeFromCart:C,updateQuantity:u}=O(),{allProducts:m}=_(),P=F(),[p,d]=g.useState(!1),[a,f]=g.useState("stripe"),[b,S]=g.useState(""),c=r=>m?.find(s=>s.id===r)?.stock??0,k=m&&m.length>0,n=k&&l.some(r=>c(r.id)<=0),i=k&&l.some(r=>{const t=c(r.id);return t>0&&r.quantity>t}),h=R(),y=z(),q={reference:new Date().getTime().toString(),email:b||"user@example.com",amount:Math.round(o*100),publicKey:"pk_test_8dd8e02cb48f76059d04b5006422896627038e23"},E=L(q),j=async()=>{try{const r=l.map(N=>({id:N.id,quantity:N.quantity}));await $(r);const s=await T({email:b,name:"Customer",items:l,total:o,payment_method:a});w(),d(!1),P(`/order-confirmation/${s.orderId}`)}catch(r){d(!1),alert(r.message||"Stock validation failed. Please refresh and try again.")}},M=async()=>{if(d(!0),a==="paystack")E(j,()=>{d(!1),alert("Payment cancelled.")});else{if(!h||!y){d(!1);return}const r=y.getElement(v),{error:t,paymentMethod:s}=await h.createPaymentMethod({type:"card",card:r});t?(console.error("[error]",t),alert(t.message),d(!1)):(console.log("[PaymentMethod]",s),setTimeout(()=>{j()},1e3))}};return l.length===0?e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background-light dark:bg-background-dark text-center p-4",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl text-gray-300 mb-4",children:"shopping_cart_off"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"Your cart is empty"}),e.jsx(x,{to:"/shop",className:"text-primary hover:underline",children:"Continue Shopping"})]}):e.jsxs("div",{className:"min-h-screen flex flex-col lg:flex-row bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 antialiased selection:bg-primary/30",children:[e.jsxs("div",{className:"w-full lg:w-[58%] xl:w-[60%] flex flex-col border-r border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark order-2 lg:order-1",children:[e.jsx("header",{className:"px-6 py-6 lg:px-12 lg:pt-8 flex items-center justify-between",children:e.jsxs(x,{to:"/",className:"flex items-center gap-3 text-slate-900 dark:text-white",children:[e.jsx("div",{className:"size-8 text-primary",children:e.jsx("span",{className:"material-symbols-outlined text-3xl",children:"school"})}),e.jsx("h2",{className:"text-xl font-bold leading-tight tracking-tight text-primary-dark dark:text-primary",children:"Educate a Rural Girl"})]})}),e.jsx("div",{className:"px-6 lg:px-12 py-2",children:e.jsxs("nav",{className:"flex flex-wrap items-center gap-2 text-sm font-medium",children:[e.jsx(x,{className:"text-primary hover:text-primary-dark transition-colors",to:"/shop",children:"Cart"}),e.jsx("span",{className:"text-slate-400 material-symbols-outlined text-sm",children:"chevron_right"}),e.jsx("span",{className:"text-slate-900 dark:text-white font-bold",children:"Payment"})]})}),e.jsxs("div",{className:"flex-1 px-6 lg:px-12 py-6 max-w-2xl mx-auto lg:mx-0 w-full",children:[e.jsxs("section",{className:"mb-10",children:[e.jsx("div",{className:"flex justify-between items-baseline mb-4",children:e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Contact Information"})}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"Email address"}),e.jsx("input",{className:"w-full h-12 px-4 rounded-lg border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-shadow placeholder:text-slate-400",placeholder:"user@example.com",type:"email",value:b,onChange:r=>S(r.target.value)})]})})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight mb-4",children:"Shipping Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"First name"}),e.jsx("input",{className:"w-full h-12 px-4 rounded-lg border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-shadow",type:"text"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"Last name"}),e.jsx("input",{className:"w-full h-12 px-4 rounded-lg border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-shadow",type:"text"})]}),e.jsxs("label",{className:"block md:col-span-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5 block",children:"Address"}),e.jsx("input",{className:"w-full h-12 px-4 rounded-lg border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark text-slate-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-shadow",placeholder:"123 Ocean Drive",type:"text"})]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight mb-4",children:"Payment Method"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Select your preferred payment gateway."}),e.jsx("div",{className:"border border-border-light dark:border-border-dark rounded-lg overflow-hidden",children:e.jsx("div",{className:"p-4 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("label",{className:`flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ${a==="stripe"?"border-primary bg-primary/5":"border-border-light dark:border-border-dark"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{checked:a==="stripe",onChange:()=>f("stripe"),className:"w-5 h-5 text-primary border-gray-300 focus:ring-primary",type:"radio",name:"payment"}),e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:"Credit Card (Stripe)"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"credit_card"})})]}),a==="stripe"&&e.jsx("div",{className:"pl-8 pr-4 py-2",children:e.jsx("div",{className:"p-4 border border-border-light dark:border-border-dark rounded bg-white dark:bg-background-dark",children:e.jsx(v,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}})})}),e.jsxs("label",{className:`flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-all ${a==="paystack"?"border-secondary bg-secondary/5":"border-border-light dark:border-border-dark"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{checked:a==="paystack",onChange:()=>f("paystack"),className:"w-5 h-5 text-secondary border-gray-300 focus:ring-secondary",type:"radio",name:"payment"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-900 dark:text-white",children:"Paystack"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Fast and secure payments"})]})]}),e.jsx("span",{className:"font-bold text-secondary text-lg",children:"P"})]})]})})})]}),e.jsxs("div",{className:"flex flex-col-reverse md:flex-row items-center justify-between gap-6 mt-8",children:[e.jsxs(x,{className:"flex items-center gap-1 text-primary font-medium hover:underline",to:"/shop",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),"Return to cart"]}),e.jsx("button",{onClick:M,disabled:p||!h&&a==="stripe"||n||i,className:`w-full md:w-auto px-8 py-3 text-white font-bold rounded-lg shadow-lg transition-all flex items-center justify-center gap-2 ${n||i?"bg-gray-400 cursor-not-allowed":a==="paystack"?"bg-secondary hover:bg-secondary-dark shadow-secondary/20":"bg-primary hover:bg-primary-dark shadow-primary/20"}`,children:n||i?"Adjust Cart Before Checkout":p?"Processing...":`Pay $${o.toFixed(2)}`})]})]})]}),e.jsx("div",{className:"w-full lg:w-[42%] xl:w-[40%] bg-surface-light dark:bg-surface-dark border-l border-border-light dark:border-border-dark order-1 lg:order-2",children:e.jsxs("div",{className:"sticky top-0 h-full max-h-screen overflow-y-auto sidebar-scroll p-6 lg:p-12 bg-slate-50 dark:bg-surface-dark/50 lg:bg-transparent",children:[e.jsx("div",{className:"space-y-6",children:l.map(r=>{const t=c(r.id),s=t<=0;return e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"relative size-16 rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-background-dark overflow-hidden",children:[e.jsx("img",{alt:r.name,className:"w-full h-full object-cover",src:r.images[0]}),e.jsx("span",{className:"absolute -top-2 -right-2 size-5 rounded-full bg-slate-500 text-white text-xs font-bold flex items-center justify-center",children:r.quantity})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:r.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:r.category}),s&&e.jsx("p",{className:"text-xs font-bold text-red-600 mt-1",children:"⚠️ OUT OF STOCK"}),!s&&r.quantity>t&&e.jsxs("p",{className:"text-xs font-bold text-orange-600 mt-1",children:["⚠️ Only ",t," available (you have ",r.quantity," in cart)"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>u(r.id,Math.max(1,r.quantity-1)),className:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300",disabled:r.quantity<=1,children:"-"}),e.jsx("span",{className:"text-sm font-medium w-8 text-center",children:r.quantity}),e.jsx("button",{onClick:()=>u(r.id,r.quantity+1),className:"w-6 h-6 rounded border border-gray-300 dark:border-gray-600 flex items-center justify-center hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-300",disabled:s||c(r.id)<=r.quantity,children:"+"})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:["$",(r.price*r.quantity).toFixed(2)]}),e.jsxs("button",{onClick:()=>C(r.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 text-xs font-medium flex items-center gap-1",title:"Remove from cart",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"}),"Remove"]})]})]},r.id)})}),e.jsxs("div",{className:"border-t border-border-light dark:border-border-dark my-6 pt-6 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Subtotal"}),e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:["$",o.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Shipping"}),e.jsx("span",{className:"text-sm font-medium text-slate-500",children:"Free"})]})]}),n&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 my-4",children:e.jsx("p",{className:"text-sm font-bold text-red-800 dark:text-red-200",children:"⚠️ Some items in your cart are now out of stock. Please remove them before checkout."})}),!n&&i&&e.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4 my-4",children:e.jsx("p",{className:"text-sm font-bold text-orange-800 dark:text-orange-200",children:"⚠️ Some items in your cart exceed available stock. Please reduce quantities before checkout."})}),e.jsx("div",{className:"border-t border-border-light dark:border-border-dark pt-6",children:e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("span",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Total"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"USD"}),e.jsxs("span",{className:"text-2xl font-black text-slate-900 dark:text-white",children:["$",o.toFixed(2)]})]})]})})]})})]})},Y=()=>e.jsx(D,{stripe:A,children:e.jsx(Q,{})});export{Y as default};
